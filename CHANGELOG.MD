# CHANGELOG

## [Unreleased]

### Add

- Add new pending items types
- Add new notification types

## [1.2.2] - 2020-10-13

## Added

- The pdf file is generated for the not invoiced sale at the end of the cfdi cancellation process. This allows to send the sale file by mail as well as the cancellation acknowledgment.

## [1.2.1] - 2020-09-22

## Added

- New mutation to cancel a not invoiced sale
- New mutation to delete a sale
- Add waitingApproval field on type InvoiceCancellation
- Add new field: "movementFolio" to the sales history queries

## [v1.2.0] - 2020-08-25

## Added

- InvoiceCancellation schema fields cancellationStatus and cancellationStatusId
- CancellationStatusEnum resolver for Enum CancellationStatusEnum
- Precalculated call for not invoiced sales
- Sale history movement when cancelling a sale after invoice cancellation

## Changed

- Bump in minor version to 2 , in order to trigger correct deployment pipelines.

## Fixed

- Fix cancellation expiration date when cancellation needs appro
- Notification for emitted invoice only on webhook request
- Get the sale pdf and xml files for a sale that is as cancelled with a notInvoiced status

## [v1.1.1] - 2020-07-28

## Added:

- Add introspect flag to configure Apollo Engine on production
- Add resolver to get the sales defaultcontact based on "invoiceContact" parameter
- Add "invoiceContact" type to the Contacts definition

## Removed

- Remove conection to paybook service on queries and mutations related:
  - companyUpdateInfo mutation
  - companyDataLocalized resolver
  - estatusDescargaCfdis resolver

## [1.1.0] - 2020-07-15

### Added

- Function that create a new sale

- Function that validate if a sale is able to be invoiced

- Function that gets the company IANAHusoHorario with a default fallback in case postal code is not set on fiscal address

- Set default emission date if not provided one.

- Validate invoice emission date according to SAT rules.

- Mutation to create/update sale invoice folio (saleAssignInvoiceFolio)

- Add new env vars

```
GX_BOA_MS_CFDI_HANDLE_BASE_URL=<URL>
GX_BOA_GRAPHQL_API_BASE_URL=<URL>
NOTIFICATION_ACTION_BASE_URL=<URL>
```

- Add clientAssingInvoiceContactDefault mutation to assing the contact that receives the emails generated by sales.

### Changed

- schema type SaleCreateInput, now discounts, and taxes are not strictly required if passed they can't be empty

- schema type SaleCreateInput, now postalCode is strictly required

- Mutation saleInvoiceCreate now changes invoicedStatus to 'invoicing' and calls cfdi handle service to execute the operation. The response of this mutation was also modified, now only returns a boolean indicating whether the operation was successful.

- saleUpdate Mutation is now an internal mutation. It will be used only for upate sale when change to not invoiced to invoiced one

- claveProductoServicioSAT, descripcionProductoServicioSAT, claveUnidadMedidaSAT, descripcionUnidadMedidaSAT are no longer required on FrequentItem type

- startDate and endDate used on sales filter, are not converted to comapny time zone. This because now date were be used to get date from minute zero from startDate to last minute of endDate. Now were received with the following format: YYYY-MM-DD
